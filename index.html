<!doctype html>
<html lang="om">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Oromia Bank - Online Service (Demo)</title>
  <meta name="description" content="Oromia Bank Online Service - Demo app (Registration, Login, Dashboard)"/>

  <!-- Tailwind via CDN for quick demo -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{--green:#006A4E;--gold:#FFD700}
    body{font-family:'Poppins',system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial}
    /* simple fade animation */
    .fade-up{animation:fadeUp .6s ease both}
    @keyframes fadeUp{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:none}}
    /* password strength bar colors */
    .pw-weak{background:#ef4444}
    .pw-medium{background:#f59e0b}
    .pw-strong{background:#10b981}
  </style>
</head>
<body class="bg-gray-50 text-gray-900 antialiased">

  <div class="min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-white shadow-sm">
      <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
          <a href="#home" class="flex items-center gap-3" data-link>
            <div class="w-10 h-10 rounded-md" style="background:linear-gradient(135deg,var(--green),#2a7a62)"></div>
            <div>
              <div class="font-bold text-lg">Oromia Bank</div>
              <div class="text-xs text-gray-500">Online Services (Demo)</div>
            </div>
          </a>

          <nav class="flex items-center gap-3">
            <button id="btn-home" class="px-3 py-1 rounded hover:bg-gray-100" data-link>Home</button>
            <button id="btn-register" class="px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700" data-link>Register Now</button>
            <button id="btn-login" class="px-3 py-1 rounded border" data-link>Login</button>
          </nav>
        </div>
      </div>
    </header>

    <!-- Main (SPA sections) -->
    <main class="flex-1">
      <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-12">

        <!-- HOME -->
        <section id="home" class="fade-up">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
            <div>
              <h1 class="text-4xl font-extrabold text-gray-900">Welcome to <span style="color:var(--green)">Oromia Bank</span> Online</h1>
              <p class="mt-4 text-gray-600">Register quickly, manage your account, transfer funds, and contact support — all in one secure place. (Demo)</p>

              <div class="mt-6 flex gap-3">
                <button id="cta-register" class="px-5 py-3 bg-green-600 text-white rounded shadow hover:bg-green-700">Register Now</button>
                <button id="cta-login" class="px-5 py-3 border rounded hover:bg-gray-100">Login</button>
              </div>

              <div class="mt-8 text-sm text-gray-500">Design: Oromia green (#006A4E) and gold accents.</div>
            </div>

            <div class="bg-white rounded-lg shadow p-6">
              <h3 class="font-semibold">Quick demo features</h3>
              <ul class="mt-3 space-y-2 text-sm text-gray-600">
                <li>• Register & Login (stored in LocalStorage)</li>
                <li>• Dashboard with balance and transactions</li>
                <li>• Fund transfer (mock) with confirmation modal</li>
                <li>• Simple support chat bot</li>
              </ul>
            </div>
          </div>
        </section>

        <!-- REGISTER -->
        <section id="register" class="mt-12 hidden fade-up">
          <div class="max-w-2xl mx-auto bg-white rounded-lg shadow p-6">
            <h2 class="text-2xl font-bold">New Customer Registration</h2>
            <p class="text-sm text-gray-500 mt-1">Fakkeenya demo: odeeffannoo keessan LocalStorage keessatti ni kuusna. For production, use a secure backend.</p>

            <form id="registerForm" class="mt-6 space-y-4">
              <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                <div>
                  <label class="text-sm">Full Name</label>
                  <input required id="reg_name" class="mt-1 w-full border rounded px-3 py-2" placeholder="Maqaa guutuu" />
                </div>
                <div>
                  <label class="text-sm">Phone Number</label>
                  <input required id="reg_phone" class="mt-1 w-full border rounded px-3 py-2" placeholder="09XXXXXXXX" />
                </div>
              </div>

              <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                <div>
                  <label class="text-sm">Email</label>
                  <input required id="reg_email" type="email" class="mt-1 w-full border rounded px-3 py-2" placeholder="email@example.com" />
                </div>
                <div>
                  <label class="text-sm">National ID</label>
                  <input required id="reg_nid" class="mt-1 w-full border rounded px-3 py-2" placeholder="ID Number" />
                </div>
              </div>

              <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                <div>
                  <label class="text-sm">Date of Birth</label>
                  <input required id="reg_dob" type="date" class="mt-1 w-full border rounded px-3 py-2" />
                </div>
                <div>
                  <label class="text-sm">Password</label>
                  <div class="relative mt-1">
                    <input required id="reg_password" type="password" class="w-full border rounded px-3 py-2" placeholder="Min 8 chars" />
                    <button type="button" id="togglePw" class="absolute right-2 top-2 text-xs text-gray-500">Show</button>
                  </div>
                  <div class="mt-2 h-2 bg-gray-200 rounded overflow-hidden">
                    <div id="pwStrength" class="h-full w-0"></div>
                  </div>
                </div>
              </div>

              <div>
                <label class="text-sm">Confirm Password</label>
                <input required id="reg_password2" type="password" class="mt-1 w-full border rounded px-3 py-2" />
              </div>

              <div class="flex items-center gap-3">
                <button type="submit" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700">Create Account</button>
                <div id="regMsg" class="text-sm text-green-600"></div>
              </div>
            </form>
          </div>
        </section>

        <!-- LOGIN -->
        <section id="login" class="mt-12 hidden fade-up">
          <div class="max-w-md mx-auto bg-white rounded-lg shadow p-6">
            <h2 class="text-2xl font-bold">Login</h2>
            <form id="loginForm" class="mt-6 space-y-4">
              <div>
                <label class="text-sm">Email or Phone</label>
                <input required id="login_id" class="mt-1 w-full border rounded px-3 py-2" />
              </div>
              <div>
                <label class="text-sm">Password</label>
                <input required id="login_pw" type="password" class="mt-1 w-full border rounded px-3 py-2" />
              </div>
              <div class="flex items-center justify-between text-sm">
                <a href="#" id="forgot">Forgot Password?</a>
                <a href="#register" id="link-create">Create New Account</a>
              </div>
              <div>
                <button type="submit" class="w-full px-4 py-2 bg-green-600 text-white rounded">Login</button>
              </div>
              <div id="loginMsg" class="text-sm text-red-600"></div>
            </form>
          </div>
        </section>

        <!-- DASHBOARD -->
        <section id="dashboard" class="mt-12 hidden fade-up">
          <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <div class="lg:col-span-2 bg-white rounded-lg shadow p-6">
              <div class="flex items-center justify-between">
                <div>
                  <h2 class="text-xl font-bold" id="dash_welcome">Welcome, User</h2>
                  <div class="text-sm text-gray-500" id="dash_account">Account: XXXX-XXXX</div>
                </div>
                <div class="text-right">
                  <div class="text-sm text-gray-500">Balance</div>
                  <div class="text-2xl font-semibold text-green-700" id="dash_balance">ETB 0.00</div>
                </div>
              </div>

              <div class="mt-6 border-t pt-4">
                <div class="flex gap-3 mb-4">
                  <button class="tabBtn px-3 py-2 bg-gray-100 rounded" data-tab="summary">Account Summary</button>
                  <button class="tabBtn px-3 py-2 rounded" data-tab="transfer">Fund Transfer</button>
                  <button class="tabBtn px-3 py-2 rounded" data-tab="history">Transaction History</button>
                  <button class="tabBtn px-3 py-2 rounded" data-tab="support">Customer Support</button>
                </div>

                <div id="tabContent">
                  <!-- SUMMARY -->
                  <div id="summary" class="tabPanel">
                    <h3 class="font-semibold">Account Summary</h3>
                    <p class="text-sm text-gray-600 mt-2">This is demo data persisted locally. For production, use secure APIs.</p>

                    <div class="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-3">
                      <div class="p-4 bg-gray-50 rounded">Account Holder: <div class="font-medium" id="sum_name">-</div></div>
                      <div class="p-4 bg-gray-50 rounded">National ID: <div class="font-medium" id="sum_nid">-</div></div>
                    </div>
                  </div>

                  <!-- TRANSFER -->
                  <div id="transfer" class="tabPanel hidden">
                    <h3 class="font-semibold">Fund Transfer</h3>
                    <form id="transferForm" class="mt-3 space-y-3 max-w-md">
                      <div>
                        <label class="text-sm">Recipient Account Number</label>
                        <input required id="t_acc" class="mt-1 w-full border rounded px-3 py-2" placeholder="e.g. 1234-5678" />
                      </div>
                      <div>
                        <label class="text-sm">Amount (ETB)</label>
                        <input required id="t_amount" type="number" min="1" class="mt-1 w-full border rounded px-3 py-2" />
                      </div>
                      <div>
                        <label class="text-sm">Description</label>
                        <input id="t_desc" class="mt-1 w-full border rounded px-3 py-2" placeholder="Payment for..." />
                      </div>
                      <div>
                        <button type="submit" class="px-4 py-2 bg-green-600 text-white rounded">Proceed</button>
                      </div>
                    </form>
                  </div>

                  <!-- HISTORY -->
                  <div id="history" class="tabPanel hidden">
                    <h3 class="font-semibold">Transaction History</h3>
                    <div id="txList" class="mt-4 space-y-2 text-sm text-gray-700"></div>
                  </div>

                  <!-- SUPPORT -->
                  <div id="support" class="tabPanel hidden">
                    <h3 class="font-semibold">Customer Support</h3>
                    <p class="text-sm text-gray-600 mt-2">Use the contact form or try the quick chat bot below.</p>

                    <div class="mt-4 grid grid-cols-1 lg:grid-cols-2 gap-4">
                      <div>
                        <form id="contactForm" class="space-y-3 bg-gray-50 p-4 rounded">
                          <div>
                            <label class="text-sm">Subject</label>
                            <input id="c_subject" class="mt-1 w-full border rounded px-3 py-2" />
                          </div>
                          <div>
                            <label class="text-sm">Message</label>
                            <textarea id="c_message" class="mt-1 w-full border rounded px-3 py-2" rows="4"></textarea>
                          </div>
                          <div>
                            <button type="submit" class="px-3 py-2 bg-green-600 text-white rounded">Send</button>
                          </div>
                        </form>
                      </div>

                      <div>
                        <div class="bg-white border rounded p-4 h-80 flex flex-col">
                          <div id="chatLog" class="flex-1 overflow-auto text-sm space-y-2"></div>
                          <div class="mt-3 flex gap-2">
                            <input id="chatInput" class="flex-1 border rounded px-3 py-2" placeholder="Type message..." />
                            <button id="chatSend" class="px-3 py-2 bg-green-600 text-white rounded">Send</button>
                          </div>
                        </div>
                      </div>
                    </div>

                  </div>

                </div>

              </div>
            </div>

            <!-- Sidebar -->
            <aside class="bg-white rounded-lg shadow p-6">
              <div class="flex items-center gap-3">
                <div class="w-12 h-12 rounded bg-green-100 flex items-center justify-center text-green-700 font-bold">OB</div>
                <div>
                  <div id="side_name" class="font-semibold">User</div>
                  <div class="text-sm text-gray-500" id="side_acc">Acct: -</div>
                </div>
              </div>

              <div class="mt-6">
                <button id="logoutBtn" class="w-full px-3 py-2 rounded border">Logout</button>
              </div>
            </aside>

          </div>
        </section>

      </div>
    </main>

    <!-- Footer -->
    <footer class="bg-white border-t">
      <div class="max-w-6xl mx-auto px-4 py-6 text-sm text-gray-600 flex flex-col sm:flex-row justify-between items-center gap-3">
        <div>© Oromia Bank - Demo - All rights reserved</div>
        <div class="flex gap-3">
          <a href="#">About Us</a>
          <a href="#">Services</a>
          <a href="#">Contact</a>
          <a href="#">Terms & Privacy</a>
        </div>
      </div>
    </footer>

    <!-- Confirmation Modal (hidden) -->
    <div id="modal" class="fixed inset-0 bg-black bg-opacity-40 hidden items-center justify-center">
      <div class="bg-white rounded-lg shadow p-6 max-w-md w-full">
        <h3 class="font-semibold">Confirm Transaction</h3>
        <div id="modalBody" class="mt-3 text-sm text-gray-700"></div>
        <div class="mt-4 flex justify-end gap-3">
          <button id="modalCancel" class="px-3 py-2 rounded border">Cancel</button>
          <button id="modalConfirm" class="px-3 py-2 bg-green-600 text-white rounded">Confirm</button>
        </div>
      </div>
    </div>

  </div>

<script>
// ===== Simple SPA navigation =====
document.querySelectorAll('[data-link]').forEach(el=>el.addEventListener('click',e=>{
  const target = (e.target.getAttribute('href') || e.target.dataset.target || e.currentTarget.id).replace('#','');
  // map some ids
  if(e.currentTarget.id === 'btn-register' || e.currentTarget.id === 'cta-register') showSection('register');
  else if(e.currentTarget.id === 'btn-login' || e.currentTarget.id === 'cta-login') showSection('login');
  else showSection('home');
}));

function showSection(id){
  ['home','register','login','dashboard'].forEach(s=>{
    const el = document.getElementById(s);
    if(!el) return;
    if(s===id) el.classList.remove('hidden'); else el.classList.add('hidden');
  });
}

// default
showSection('home');

// ===== Registration logic (LocalStorage demo) =====
const registerForm = document.getElementById('registerForm');
const regMsg = document.getElementById('regMsg');
const pwInput = document.getElementById('reg_password');
const pwStrength = document.getElementById('pwStrength');
const togglePw = document.getElementById('togglePw');
let users = JSON.parse(localStorage.getItem('ob_users')||'[]');

function genAccount(){
  return 'OB-'+Math.floor(100000 + Math.random()*900000);
}

function calcPwStrength(pw){
  let score = 0;
  if(pw.length>=8) score++;
  if(/[A-Z]/.test(pw)) score++;
  if(/[0-9]/.test(pw)) score++;
  if(/[^A-Za-z0-9]/.test(pw)) score++;
  return score;
}

pwInput.addEventListener('input',()=>{
  const s = calcPwStrength(pwInput.value);
  pwStrength.style.width = (s*25)+'%';
  pwStrength.className = '';
  if(s<=1) pwStrength.classList.add('pw-weak');
  else if(s===2||s===3) pwStrength.classList.add('pw-medium');
  else pwStrength.classList.add('pw-strong');
});

togglePw.addEventListener('click',()=>{
  if(pwInput.type==='password'){pwInput.type='text'; togglePw.textContent='Hide'}else{pwInput.type='password'; togglePw.textContent='Show'}
});

registerForm.addEventListener('submit',e=>{
  e.preventDefault();
  const name = document.getElementById('reg_name').value.trim();
  const phone = document.getElementById('reg_phone').value.trim();
  const email = document.getElementById('reg_email').value.trim();
  const nid = document.getElementById('reg_nid').value.trim();
  const dob = document.getElementById('reg_dob').value;
  const pw = document.getElementById('reg_password').value;
  const pw2 = document.getElementById('reg_password2').value;

  if(pw!==pw2){ regMsg.textContent='Passwords do not match'; return }
  if(pw.length<8){ regMsg.textContent='Password must be at least 8 chars'; return }

  // basic duplicate check
  if(users.find(u=>u.email===email||u.phone===phone||u.nid===nid)){
    regMsg.textContent='User with same email/phone/NID already exists'; return;
  }

  const account = genAccount();
  const user = {id:account,name,phone,email,nid,dob,password:pw,balance:5000,transactions:[]};
  users.push(user);
  localStorage.setItem('ob_users',JSON.stringify(users));

  regMsg.textContent = 'Account created! Account: '+account;
  registerForm.reset();
  pwStrength.style.width='0%';

  // Auto-login demo: open dashboard for created user
  setTimeout(()=>{
    loginUserByAccount(account);
  },800);
});

// ===== Login =====
const loginForm = document.getElementById('loginForm');
const loginMsg = document.getElementById('loginMsg');

loginForm.addEventListener('submit',e=>{
  e.preventDefault();
  const id = document.getElementById('login_id').value.trim();
  const pw = document.getElementById('login_pw').value;
  const found = users.find(u=>u.email===id||u.phone===id||u.id===id);
  if(!found || found.password!==pw){ loginMsg.textContent='Invalid credentials'; return }
  loginMsg.textContent='';
  loginUser(found);
});

function loginUserByAccount(acc){
  const found = users.find(u=>u.id===acc);
  if(found) loginUser(found);
}

function loginUser(user){
  localStorage.setItem('ob_current',user.id);
  renderDashboard(user.id);
  showSection('dashboard');
}

// ===== Dashboard rendering & tabs =====
const tabBtns = document.querySelectorAll('.tabBtn');
const tabPanels = document.querySelectorAll('.tabPanel');

tabBtns.forEach(btn=>{
  btn.addEventListener('click',()=>{
    tabBtns.forEach(b=>b.classList.remove('bg-gray-100'));
    btn.classList.add('bg-gray-100');
    const t = btn.dataset.tab;
    tabPanels.forEach(p=>p.classList.add('hidden'));
    document.getElementById(t).classList.remove('hidden');
  });
});

function renderDashboard(userId){
  users = JSON.parse(localStorage.getItem('ob_users')||'[]');
  const user = users.find(u=>u.id===userId);
  if(!user) return;
  document.getElementById('dash_welcome').textContent = 'Welcome, '+user.name.split(' ')[0];
  document.getElementById('dash_account').textContent = 'Account: '+user.id;
  document.getElementById('dash_balance').textContent = 'ETB '+Number(user.balance).toFixed(2);
  document.getElementById('sum_name').textContent = user.name;
  document.getElementById('sum_nid').textContent = user.nid;
  document.getElementById('side_name').textContent = user.name;
  document.getElementById('side_acc').textContent = 'Acct: '+user.id;

  // render transactions
  const txList = document.getElementById('txList'); txList.innerHTML='';
  if(user.transactions && user.transactions.length){
    user.transactions.slice().reverse().forEach(tx=>{
      const div = document.createElement('div');
      div.className='p-3 bg-gray-50 rounded';
      div.innerHTML = `<div class=\"font-medium\">${tx.type} - ETB ${Number(tx.amount).toFixed(2)}</div><div class=\"text-xs text-gray-500\">${tx.desc} • ${new Date(tx.when).toLocaleString()}</div>`;
      txList.appendChild(div);
    });
  } else {
    txList.innerHTML = '<div class="text-sm text-gray-500">No transactions yet.</div>';
  }
}

// if already logged in, show dashboard
const current = localStorage.getItem('ob_current');
if(current){
  renderDashboard(current);
  showSection('dashboard');
}

// ===== Transfer flow with modal confirmation =====
const transferForm = document.getElementById('transferForm');
const modal = document.getElementById('modal');
const modalBody = document.getElementById('modalBody');
const modalConfirm = document.getElementById('modalConfirm');
const modalCancel = document.getElementById('modalCancel');
let pendingTransfer = null;

transferForm && transferForm.addEventListener('submit',e=>{
  e.preventDefault();
  const acc = document.getElementById('t_acc').value.trim();
  const amt = Number(document.getElementById('t_amount').value);
  const desc = document.getElementById('t_desc').value.trim();
  const userId = localStorage.getItem('ob_current');
  const user = users.find(u=>u.id===userId);
  if(!user) return;
  if(amt<=0){ alert('Enter valid amount'); return }
  if(amt>user.balance){ alert('Insufficient balance'); return }
  pendingTransfer = {from:user.id,to:acc,amount:amt,desc,when:Date.now()};
  modalBody.innerHTML = `<div class=\"text-sm\">Send <strong>ETB ${amt.toFixed(2)}</strong> to <strong>${acc}</strong>?</div><div class=\"mt-2 text-xs text-gray-500\">Description: ${desc}</div>`;
  modal.classList.remove('hidden');
});

modalCancel.addEventListener('click',()=>{ modal.classList.add('hidden'); pendingTransfer=null });
modalConfirm.addEventListener('click',()=>{
  if(!pendingTransfer) return; 
  const fromUser = users.find(u=>u.id===pendingTransfer.from);
  fromUser.balance -= pendingTransfer.amount;
  fromUser.transactions.push({type:'Transfer Out',amount:pendingTransfer.amount,desc:pendingTransfer.desc,when:pendingTransfer.when});
  // For demo, if recipient exists, credit them
  const recip = users.find(u=>u.id===pendingTransfer.to);
  if(recip){
    recip.balance += pendingTransfer.amount;
    recip.transactions.push({type:'Transfer In',amount:pendingTransfer.amount,desc:pendingTransfer.desc,when:pendingTransfer.when});
  }
  localStorage.setItem('ob_users',JSON.stringify(users));
  modal.classList.add('hidden'); pendingTransfer=null;
  renderDashboard(localStorage.getItem('ob_current'));
  alert('Transfer completed (demo).');
});

// ===== Contact form =====
const contactForm = document.getElementById('contactForm');
contactForm && contactForm.addEventListener('submit',e=>{
  e.preventDefault();
  alert('Message sent to support (demo).');
  contactForm.reset();
});

// ===== Chat bot simple =====
const chatLog = document.getElementById('chatLog');
const chatInput = document.getElementById('chatInput');
const chatSend = document.getElementById('chatSend');

function appendChat(msg, who='bot'){
  const div = document.createElement('div');
  div.className = who==='bot'? 'text-sm text-gray-700':'text-sm text-right text-green-700';
  div.textContent = msg;
  chatLog.appendChild(div);
  chatLog.scrollTop = chatLog.scrollHeight;
}

chatSend.addEventListener('click',()=>{
  const t = chatInput.value.trim(); if(!t) return;
  appendChat(t,'user'); chatInput.value='';
  appendChat('Typing...','bot');
  setTimeout(()=>{
    chatLog.lastChild.textContent = getBotReply(t);
  },800);
});

function getBotReply(msg){
  const m = msg.toLowerCase();
  if(m.includes('balance')) return 'Your current balance is shown on the dashboard.';
  if(m.includes('transfer')) return 'Go to Fund Transfer tab to proceed. Ensure sufficient balance.';
  if(m.includes('contact')||m.includes('support')) return 'Use the contact form or email support@oromiabank.demo (demo).';
  return 'Thank you — our agent will contact you soon (demo).';
}

// ===== Logout =====
const logoutBtn = document.getElementById('logoutBtn');
logoutBtn && logoutBtn.addEventListener('click',()=>{
  localStorage.removeItem('ob_current');
  // option: go to home
  showSection('home');
});

</script>
</body>
</html>
